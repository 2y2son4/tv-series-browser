"use strict";const apiUrl="http://api.tvmaze.com/search/shows?q=",noImageUrlText="Image not found";let noImageUrl="https://via.placeholder.com/210x295/ffffff/666666/?text=Image not found",noImageUrlFavorite="https://via.placeholder.com/125x175/ffffff/666666/?text=Image not found";const formElement=document.querySelector(".js-form"),searchInputElement=document.querySelector(".js-search-input"),searchBtnElement=document.querySelector(".js-search-btn"),favoriteSection=document.querySelector(".js-favorite-shows");let shows=[],favoriteShows=[];function handleForm(e){e.preventDefault()}function getDataFromApi(){const e=searchInputElement.value;fetch(apiUrl+e).then(e=>e.json()).then(e=>{shows=e,paintSearchCards(),paintFavoriteCards(),setInLocalStorage()})}function paintSearchCards(){let e,t='<ul class="main__list">';for(const o of shows){e=void 0===favoriteShows.find(e=>e.show.id===o.show.id)?"":" card--favorite",t+=`<li class="main__list--element js-list-element${e}" id="${o.show.id}">`,null===o.show.officialSite?t+=`<h2 class="main__card--title">${o.show.name}</h2>`:(t+='<h2 class="main__card--title">',t+=`<a class="main__card--link" href="${o.show.officialSite}" target="_blank" title="${o.show.name} official site">${o.show.name}</a>`,t+="</h2>"),null===o.show.image?t+=`<img class="js-image main__card--img" src="${noImageUrl}" alt="${o.show.name}" />`:t+=`<img class="js-image main__card--img" src="${o.show.image.medium}" alt="${o.show.name}" />`,null===o.show.rating.average?t+='<span class="page__card--rating">-- / 10</span>':t+=`<span class="page__card--rating">${o.show.rating.average} / 10</span>`,t+="</li>"}t+="</ul>",removeListenShowEvents();document.querySelector(".js-search-shows").innerHTML=t,listenShowEvents()}function paintFavoriteCards(){let e;e=0===favoriteShows.length?" hidden":"";let t=`<div class="main__favorite${e}">`;t+='<button class="js-reset-btn main__favorite--btn">Clean favorites</button>',t+='<ul class="main__list--fav js-list-favorites">';for(const e of favoriteShows)t+=`<li class="js-list-element-favorite main__list--lifav" id="${e.show.id}">`,t+=`<h3 class="page__card--title">${e.show.name}</h3>`,null===e.show.image?t+=`<img class="js-image page__card--img" src="${noImageUrlFavorite}" alt="${e.show.name}" />`:t+=`<img class="js-image page__card--img" src="${e.show.image.medium}" alt="${e.show.name}" />`,t+="</li>";t+="</ul>",t+="</div>",removeListenReset(),removeListenFavoriteShowEvents();document.querySelector(".js-favorite-shows").innerHTML=t,listenFavoriteShowEvents(),listenResetBtn(),setInLocalStorage()}function listenShowEvents(){const e=document.querySelectorAll(".js-list-element");for(const t of e)t.addEventListener("click",handleShow)}function handleShow(e){const t=Number(e.currentTarget.id);if(void 0===favoriteShows.find(e=>e.show.id===t)){const e=shows.find(e=>t===e.show.id);favoriteShows.push(e)}else{const e=favoriteShows.filter(e=>e.show.id!==t);favoriteShows=e}paintSearchCards(),paintFavoriteCards()}function removeListenShowEvents(){const e=document.querySelectorAll(".js-list-element");for(const t of e)t.removeEventListener("click",handleShow)}function listenFavoriteShowEvents(){const e=document.querySelectorAll(".js-list-element-favorite");for(const t of e)t.addEventListener("click",handleFavoriteShow)}function handleFavoriteShow(e){const t=Number(e.currentTarget.id);if(void 0===favoriteShows.find(e=>e.show.id===t)){const e=shows.find(e=>t===e.show.id);favoriteShows.push(e)}else{const e=favoriteShows.filter(e=>e.show.id!==t);favoriteShows=e}paintSearchCards(),paintFavoriteCards()}function removeListenFavoriteShowEvents(){const e=document.querySelectorAll(".js-list-element-favorite");for(const t of e)t.removeEventListener("click",handleFavoriteShow)}function setInLocalStorage(){localStorage.setItem("favoriteShows",JSON.stringify(favoriteShows))}function getFromLocalStorage(){const e=JSON.parse(localStorage.getItem("favoriteShows"));null!==e&&(favoriteShows=e)}function handleResetBtn(){favoriteShows=[],paintFavoriteCards(),paintSearchCards()}function listenResetBtn(){document.querySelector(".js-reset-btn").addEventListener("click",handleResetBtn)}function removeListenReset(){const e=document.querySelector(".js-reset-btn");null!==e&&e.removeEventListener("click",handleResetBtn)}formElement.addEventListener("submit",handleForm),searchBtnElement.addEventListener("click",getDataFromApi),getFromLocalStorage(),paintFavoriteCards();